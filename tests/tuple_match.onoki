external int_to_string : int -> string = "static java/lang/String valueOf (I)Ljava/lang/String;"

let test_match = fun p ->
  match p with
  | (0, 0) -> 0
  | (0, y) -> y
  | (x, 0) -> x
  | (x, y) -> x + y

let test_nested = fun t ->
  match t with
  | ((0, 0), _) -> 100
  | ((1, _), x) -> 200 + x
  | (_, (2, 2)) -> 300
  | _ -> 400

let res = 
  "Match (0,0): " ^ (int_to_string (test_match (0, 0))) ^ "\n" ^
  "Match (0,5): " ^ (int_to_string (test_match (0, 5))) ^ "\n" ^
  "Match (7,0): " ^ (int_to_string (test_match (7, 0))) ^ "\n" ^
  "Match (3,4): " ^ (int_to_string (test_match (3, 4))) ^ "\n" ^
  "Nested ((0,0), 9): " ^ (int_to_string (test_nested ((0,0), 9))) ^ "\n" ^
  "Nested ((1,5), 50): " ^ (int_to_string (test_nested ((1,5), 50)))

